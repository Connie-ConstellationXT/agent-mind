<IntentDOM root="MakeOmelette">
  <MakeOmelette>
    <Description>Prepare and cook a basic cheese omelette</Description>
    <Output format="cooked_dish" audience="cook">Ready-to-eat omelette on plate</Output>
    
    <RequiredResource resourceName="eggs" quantity="2-3" />
    <RequiredResource resourceName="cheese" type="grated" quantity="50g" />
    <RequiredResource resourceName="butter" quantity="1tbsp" />
    <RequiredResource resourceName="salt_pepper" />
    <RequiredResource resourceName="non_stick_pan" />
    <RequiredResource resourceName="spatula" />
    
    <Constraint type="temperature">Medium heat throughout cooking</Constraint>
    <Constraint type="timing">Total cook time 3-4 minutes</Constraint>
    
    <StagingPhase>
      <Description>Quality assurance checks before ingredient preparation</Description>
      
      <TestEggFreshness>
        <Description>Perform canonical water float test to verify egg quality</Description>
        <RequiredResource resourceName="clear_bowl" />
        <RequiredResource resourceName="water" temperature="room_temp" />
        
        <FillBowl with="water" depth="sufficient_to_submerge_egg" />
        <SubmergeEgg ref="first_egg" into="water_bowl" />
        
        <ObserveFloat>
          <AcceptanceCriteria>
            <Fresh condition="egg_sinks_lies_flat">Proceed with this egg</Fresh>
            <Questionable condition="egg_stands_upright">Use within today only</Questionable>
            <Spoiled condition="egg_floats">Discard and select replacement</Spoiled>
          </AcceptanceCriteria>
        </ObserveFloat>
        
        <TestAdditionalEggs>
          <Constraint>Test each egg individually before use</Constraint>
          <Action>Repeat test for remaining eggs as needed</Action>
        </TestAdditionalEggs>
        
        <Output>
          <Artifact name="verified_fresh_eggs">
            <Type>instrument</Type>
            <Type>validation_data</Type>
            <Description>Fresh eggs verified for cooking</Description>
          </Artifact>
        </Output>
      </TestEggFreshness>
      
      <ValidateOtherIngredients>
        <CheckCheese for="mold_signs" />
        <CheckButter for="rancidity" />
        <VerifyPanCondition status="clean_non_stick_intact" />
      </ValidateOtherIngredients>
    </StagingPhase>
    
    <PrepareIngredients>
      <RequiredResource resourceName="verified_fresh_eggs" provides="staging_phase" />
      <Description>Ready all ingredients before cooking starts</Description>
      <CrackEggs quantity="2-3" into="bowl" />
      <SeasonEggs with="salt_pepper" />
      <WhiskEggs until="well_combined" />
      <GrateCheese quantity="50g" type="cheddar_or_gruyere" />
    </PrepareIngredients>
    
    <CookOmelette>
      <Description>Execute cooking sequence with timing control</Description>
      
      <HeatPan>
        <Action>Heat non-stick pan over medium heat</Action>
        <IdleWait duration="1m" reason="Pan heating" />
      </HeatPan>
      
      <AddButter>
        <Action>Add butter to heated pan, swirl to coat</Action>
        <WaitForSignal signal="butter_sizzling_gently" />
      </AddButter>
      
      <SyncPoint name="PanReadyEggsPrepped">
        <WaitForPrecept ref="HeatPan" />
        <WaitForPrecept ref="AddButter" />
        <WaitForPrecept ref="PrepareIngredients" />
        <Action>Pour whisked eggs into buttered pan</Action>
      </SyncPoint>
      
      <CookBase>
        <Action>Let eggs set on bottom while stirring gently</Action>
        <IdleWait duration="45s" reason="Base setting" />
        <Constraint type="technique">Gentle circular stirring to prevent sticking</Constraint>
      </CookBase>
      
      <AddCheese>
        <Action>Sprinkle grated cheese over half the omelette</Action>
        <Constraint type="placement">Cheese on one half only for folding</Constraint>
      </AddCheese>
      
      <FoldAndFinish>
        <Action>Fold omelette in half using spatula</Action>
        <IdleWait duration="30s" reason="Final cooking and cheese melting" />
        <Action>Slide onto plate</Action>
      </FoldAndFinish>
    </CookOmelette>
    
    <ContextSwitchProtocol>
      <PreservationRule>Save pan temperature and cooking stage</PreservationRule>
      <PreservationRule>Note egg consistency state</PreservationRule>
      <PreservationRule>Track timing since eggs hit pan</PreservationRule>
      <ResumptionPoint stage="any">Can resume at any cooking stage with timing adjustment</ResumptionPoint>
    </ContextSwitchProtocol>
  </MakeOmelette>
</IntentDOM>